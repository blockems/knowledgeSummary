2023-08-17 21:03:36,077 - utils - INFO - <module> - debug: True
2023-08-17 21:03:36,077 - utils - INFO - <module> - log_level: DEBUG
2023-08-17 21:03:36,077 - utils - INFO - <module> - Data connection string: ./data/database.db
2023-08-17 21:03:36,077 - utils - INFO - <module> - Data source directory: ./data/database.db
2023-08-17 21:03:36,077 - utils - INFO - <module> - Data processed directory: ./data/database.db
2023-08-17 21:03:36,082 - utils - DEBUG - <module> - contract schema: {'name': 'contract_summary', 'description': 'output object for a contract summary', 'parameters': {'title': 'Contract', 'type': 'object', 'properties': {'contact_name': {'title': 'Contact Name', 'type': 'string'}, 'contract_number': {'title': 'Contract Number', 'type': 'string'}, 'client_name': {'title': 'Client Name', 'type': 'string'}, 'date_created': {'title': 'Date Created', 'type': 'string', 'format': 'date'}, 'number_of_pages': {'title': 'Number Of Pages', 'type': 'integer'}, 'header': {'title': 'Header', 'type': 'string'}, 'footer': {'title': 'Footer', 'type': 'string'}, 'review_dates': {'title': 'Review Dates', 'type': 'array', 'items': {'$ref': '#/definitions/ReviewDate'}}, 'content': {'title': 'Content', 'type': 'array', 'items': {'$ref': '#/definitions/Content'}}}, 'required': ['contact_name', 'contract_number', 'client_name', 'date_created', 'number_of_pages', 'header', 'footer', 'review_dates', 'content'], 'definitions': {'Action': {'title': 'Action', 'type': 'object', 'properties': {'create_date': {'title': 'Create Date', 'type': 'string', 'format': 'date'}, 'due_date': {'title': 'Due Date', 'type': 'string', 'format': 'date'}, 'priority': {'title': 'Priority', 'type': 'string'}, 'reference': {'title': 'Reference', 'type': 'string'}, 'who': {'title': 'Who', 'type': 'string'}, 'name': {'title': 'Name', 'type': 'string'}, 'description': {'title': 'Description', 'type': 'string'}, 'next_steps': {'title': 'Next Steps', 'type': 'string'}}, 'required': ['create_date', 'due_date', 'priority', 'reference', 'who', 'name', 'description', 'next_steps']}, 'ReviewDate': {'title': 'ReviewDate', 'type': 'object', 'properties': {'date': {'title': 'Date', 'type': 'string', 'format': 'date'}, 'instruction': {'title': 'Instruction', 'type': 'string'}, 'findings': {'title': 'Findings', 'type': 'string'}, 'actions': {'title': 'Actions', 'type': 'array', 'items': {'$ref': '#/definitions/Action'}}}, 'required': ['date', 'instruction', 'findings', 'actions']}, 'Reference': {'title': 'Reference', 'type': 'object', 'properties': {'folder': {'title': 'Folder', 'type': 'string'}, 'document': {'title': 'Document', 'type': 'string'}, 'page': {'title': 'Page', 'type': 'string'}, 'paragraph': {'title': 'Paragraph', 'type': 'string'}, 'content': {'title': 'Content', 'type': 'string'}}, 'required': ['folder', 'document', 'page', 'paragraph', 'content']}, 'Content': {'title': 'Content', 'type': 'object', 'properties': {'summary': {'title': 'Summary', 'type': 'string'}, 'create_date': {'title': 'Create Date', 'type': 'string', 'format': 'date'}, 'last_updated': {'title': 'Last Updated', 'type': 'string', 'format': 'date'}, 'token_count': {'title': 'Token Count', 'type': 'integer'}, 'references': {'title': 'References', 'type': 'array', 'items': {'$ref': '#/definitions/Reference'}}}, 'required': ['summary', 'create_date', 'last_updated', 'token_count', 'references']}}}, 'return_type': 'json'}
2023-08-17 21:03:36,084 - utils - DEBUG - <module> - expert schema: {'name': 'get_experts', 'description': 'Get a list of experts for answering this question', 'parameters': {'title': 'ExpertsModel', 'type': 'object', 'properties': {'experts': {'title': 'Experts', 'type': 'array', 'items': {'$ref': '#/definitions/Expert'}}}, 'required': ['experts'], 'definitions': {'Expert': {'title': 'Expert', 'type': 'object', 'properties': {'Name': {'title': 'Name', 'type': 'string'}, 'Description': {'title': 'Description', 'type': 'string'}}, 'required': ['Name', 'Description']}}}, 'return_type': 'json'}
2023-08-17 21:03:36,084 - utils - DEBUG - split_pdfs_in_directory - Found pre processing directory: ./source/preprocessed
2023-08-17 21:03:36,084 - utils - DEBUG - split_pdfs_in_directory - Found processed directory: ./source\processed
2023-08-17 21:03:36,084 - utils - INFO - split_pdfs_in_directory - PDF processing completed.
2023-08-17 21:03:36,085 - utils - DEBUG - process_json - Found 1 JSON files in ./source/preprocessed
2023-08-17 21:03:36,094 - utils - DEBUG - process_json - Skipping page 1 as it has already been processed
2023-08-17 21:03:36,094 - utils - DEBUG - process_json - Skipping page 2 as it has already been processed
2023-08-17 21:03:36,094 - utils - DEBUG - process_json - Skipping page 3 as it has already been processed
2023-08-17 21:03:36,094 - utils - DEBUG - process_json - Skipping page 4 as it has already been processed
2023-08-17 21:03:36,094 - utils - DEBUG - process_json - Skipping page 5 as it has already been processed
2023-08-17 21:03:36,094 - utils - DEBUG - process_json - Skipping page 6 as it has already been processed
2023-08-17 21:03:36,094 - utils - DEBUG - process_json - Skipping page 7 as it has already been processed
2023-08-17 21:03:36,094 - utils - DEBUG - process_json - Processing page 8
2023-08-17 21:03:36,094 - utils - DEBUG - process_json - 
                     -----------------------------------
                        Processing Page: 
                     ------------------------------
                     {'page_number': 8, 'token_count': 415, 'content': 'NPP Implementation and Run SOW (NAB41496) to ITO Module (CON002328) and MOA (CON002254)  \nNAB & SUPPLIER CONFIDENTIAL                                      26999162_67  Page 8 of 243 \n Dovetail ; \n SunGard Financial Services ; \n Smartstream Technologies ; \n ACI Worldwide Inc. ; \n Fidelity Information Systems ; \n Fiserv ; \n Bottomline Technologies (including Sterci)  \n CGI (including Logica) ; \n Polaris CGI (including Logica) (including iGTB) ; \n Nucleus Software ; \n Reval ; \n HCL; \n Logica ; \n SilverLake ; \n Oracle ; \n NTT Data ; \n TCS; and  \n IBM. \nFundtech IP  has the meaning given in clause 6.5 of Appendix 15 . \nFundtech IP Transfer Conditions means the terms  and conditions set out in clause 1.2 of Appendix \n15.   \nFundtech Materials has the meaning given to it in clause 1.2(c) of Appendix 15 .  \nGo Live  means the date the Solution provided by the Service Provider has passed Industry Testing 1 to \n4 and goes live and has started processing customer transactions in a production environment ( Goes \nLive, Go-Live and Gone Live  have  a corresponding meaning).  \nGo Live Date  means the date set out in the Industry Schedule (currently set by NPPA as 27 August \n2017 ), as amended from time to time by NPPA . \nGood Industry Practice  means:  \n using standards, practices, methods and procedures conforming to the banking laws (as \napplicable) and all other laws relevant to the performance of the Services; and  \n exercising that degree of skill and care, diligence, prudence and foresight which would reasonably \nand ordinarily be expected from a skilled and experienced provider of services that are of the \nsame nature as the Services for a customer that operates a banking payment system.  '}
2023-08-17 21:03:36,094 - utils - DEBUG - process_json - Total tokens: 415
                     ---------------------------
2023-08-17 21:03:36,094 - utils - DEBUG - process_json - Processing page 9
2023-08-17 21:03:36,094 - utils - DEBUG - process_json - 
                     -----------------------------------
                        Processing Page: 
                     ------------------------------
                     {'page_number': 9, 'token_count': 638, 'content': 'NPP Implementation and Run SOW (NAB41496) to ITO Module (CON002328) and MOA (CON002254)  \nNAB & SUPPLIER CONFIDENTIAL                                      26999162_67  Page 9 of 243 Government Agency means any governmental, semi -governmental , administrative, f iscal, judicial or \nquasi -judicial body, de partment, commission , authority , tribunal, agency or entity.   \nGPP  means Global PayPlus  or GlobalPAYplus . \nGRC  means Group Risk Compliance . \nHours of Coverage means twenty -four ( 24) hours per day,  seven (7) days per week,  365 (or 366 , as \napplicable ) days per year.   \nHLD means high level design.   \nHSM  means Hardware Security Module . \nIAM means NAB  Identity and Access Management.  \nIBM GTS has the meaning given to it in clause 1.2(f) of Appendix 15 . \nIBM GTS Services has the meaning given to it in clause 1.2(f) of Appendix 15 . \nIBM GTS Scope of Access has the meaning given to it in clause 1.2(f) of Appendix 15 . \nIDAM  means Oracle Identity and Access Management . \nImpact Assessment Form  means the form of that name set out in Schedule 4 of the MOA.  \nImplementation Phase means  the period of time and activities performed or to be performed in \ndesigning and building the Solution prior to Go Live  and includes those activities d escribed in Appendix \n2.2.  \nImplementation Services means the Services to be performed by the Service Provider during the \nImplementation Phase.  \nIncident has the meaning given in Attachment 1 the ITO Module.   \nIndustry Schedule  means the schedule se t out in  ‘05.16.19 NPP High Level Industry Plan 20150721 \nv0.20.mpp’ (forming part of  Appendix 1 ) as updated from time to time.   \nInstallation Site  means the NAB data centres.  \nInitial Term  has the meaning given in clause 4.2. \nIntellectual Property Rights has the meaning given in the MOA .  \nITO Module has the me aning given to it in clause 2.1.  \nKey Milestone  has the meaning given in Appendix 13 .   \nKey Performance Indicator or KPI has the meaning given in the ITO Module .  \nKey Positions are set out in Appendix 7 .  \nKey Personnel has the meaning given in the MOA and are set out in Appendix 7 .  \nLaws  means the co mmon law and any statute, regulation, order, rule, subordinate legislation, regulatory \ncodes, guidelines, licence, permit, authorisation, accreditation, code of practice or other document or \nrequirement enforceable or issued under any statute, regulation, order, rule or subordinate legislation . \nLiquidated Damages  means the amounts specified as such in clause 10 of Appendix 15  for the \nrelevant Key Milestone . '}
2023-08-17 21:03:36,094 - utils - DEBUG - process_json - Total tokens: 1053
                     ---------------------------
2023-08-17 21:03:36,094 - utils - DEBUG - process_json - Processing page 10
2023-08-17 21:03:36,094 - utils - DEBUG - process_json - 
                     -----------------------------------
                        Processing Page: 
                     ------------------------------
                     {'page_number': 10, 'token_count': 688, 'content': 'NPP Implementation and Run SOW (NAB41496) to ITO Module (CON002328) and MOA (CON002254)  \nNAB & SUPPLIER CONFIDENTIAL                                      26999162_67  Page 10 of 243 Locations  has the meaning given in clause 11.  \nLoss  means any loss , liability, damage, cost or expense (including all legal and other professional costs \nand disbursements).  \nMajor Regulatory Change has the meaning given to it in clause 11 of Appendix 15 .  \nMinor Regulatory Change has the meaning given to it in clause 11 of Appendix 15 .  \nManagement Board  has the meaning given in  Schedule 1 of  the MOA.  \nMilestone  means  the completion or achievement of an agreed activity or result (or set of activities or \nresults) by the Service Provider, as specified in this Agreement  or the  Project P lan.  Milestones may \ninclude (without limitation) delivering specific Deliverables, ach ieving Acceptance for specific \nDeliverables, and achieving Acceptance for the Solution.  \nMinor Enhancement  has the meaning given in Appendix 4.4.    \nMOA has the meaning given to it in clause 2.1. \nNAB means National Australia Bank Limited.  \nNAB Agreements has the meaning given to it in clause 7.12(b) . \nNAB Assets  means the data centres and any other asset approved by NAB for the purposes of \nproviding the Services.  \nNAB Data Centre means the data centre operated by NAB.  \nNAB Direct Loss  has the meaning given in clause 18 of Appendix 15 . \nNAB Group has the meaning given to it in the MOA.  \nNAB Group Company has the meaning given in the MOA.  \nNAB Compensation Amount  has the meaning given to it in clause 18 of Appendix 15 .  \nNAB Nominee means a third party engaged by NAB to act on its behalf under this Agreement  or \notherwise provide a service to NAB,  subject to compliance with Fundtech IP Transfer Conditions.  \nNAB’s NPP Program  means NAB’s program to implement, and to exploit the potential of, the industry \nsponsored NPP and includes the receipt of services, goods and/or solution to be provided by the \nService Provider  and the ongoing maintenance and enhancement of the Payments Pla tform.  \nNAB Permitted Entities  means  NAB and each NAB Group Company and NAB Nominees.  \nNAB Policies means NAB’s wri tten policies, guidelines, proc edures and standards which are noti fied to \nService Provider  in writing  from time to time and includes any update s to such policies, guidelines, \nprocedures and standards which are notified by NAB to the Service Provider in writing from time to time  \nNFT means Non Functional Test . \nNPP or NPP Program  has the meaning given in clause 5.1. \nNPPA  means  NPP Australia Limited.  \nNPP Rules means all rules and mandatory requirements issued by NPPA from time to time  as notified \nby NAB to the Service Provider . \nObje ctives  has the meaning given in clause 5.3. '}
2023-08-17 21:03:36,094 - utils - DEBUG - process_json - Total tokens: 1741
                     ---------------------------
2023-08-17 21:03:36,094 - utils - DEBUG - process_json - Processing page 11
2023-08-17 21:03:36,094 - utils - DEBUG - process_json - 
                     -----------------------------------
                        Processing Page: 
                     ------------------------------
                     {'page_number': 11, 'token_count': 591, 'content': 'NPP Implementation and Run SOW (NAB41496) to ITO Module (CON002328) and MOA (CON002254)  \nNAB & SUPPLIER CONFIDENTIAL                                      26999162_67  Page 11 of 243 Open Source Licence Terms  has the meaning given in clause 28 of Appendix 15 . \nOpen Source Software  means any software that is licensed to either  the Service Pro vider or NAB  on \nterms that allow the licensee:  \n(a) to access, reproduce and modify the source code for the software; and  \n(b) to redistribute copies of the software, in either its original or a modified form,  \nbut only on condition that the licensee provides the recipient with access to the source code for the \nsoftware.  \nOLA s are set out in Appendix 3.2.  \nOther Contractors  has the meaning given to it in clause 15 of Appendix 15 .  \nPAG  means Payment Access Gateway . \nPayments Platform  or Platform  has the meaning given in clause 5.2.  \nPeak Payment Transactions Volumes  has the meaning given in clause 9 of Appendix 4.1  \nPerformance C ategories  means the meaning  set out in Schedule 1 of the IT O Module.  \nPerformance Guarantee Period  or PGP has the meaning given to it in clause 9(a) of Appendix 15 . \nPKI means Public Key Infrastructure . \nPre-existing Intellectual Property  means Intellectual Pr operty Rights which the Service Provider  can \nestablish came into existence other than in connection with the provision of Services and which are \nowne d by or licensed to the Service Provider  and includes the Fundtech IP . \nPricing Change Process means the process set out in Appendix 4.3.  \nProject Plan means the plan  referred to in Appendix 11  once approved in accordance with the A&D \nSOW,  as updated by the parties and approved by NAB from time to time.  \nRBA means Reserve Bank of Australia . \nRemediation has the meaning given to it in Appendix 3.3.  \nReview Due Date has the meaning given to it in clause 8.17.  \nRegulator  has the meaning given to it in the MOA.  \nRelated Body Corporate has the meaning given in the MOA.  \nRelease Condition  has the meaning given in clause 13.2 of Appendix 15 . \nResources means all  software, third party contracts, and hardware used by Service Provider to operate \nthe Payments Platform and perform the Services.  \nResourcing Estimate has the meaning given to it in clause 1 of Appendix 10 . \nRetained Amount has the meaning given to it in clause 9(b) of Appendix 15 .  \nRisk Scenario  has the meaning given to it in clause 7.1 of Appendix 4.3.   '}
2023-08-17 21:03:36,095 - utils - DEBUG - process_json - 
                     ----------------------------------
                        Finished run at page 11
                        Total tokens: 1741
                        Token limit: 2000
                     ----------------------------------
2023-08-17 21:03:36,095 - utils - DEBUG - process_json - JSON object: {'document_name': 'NAP NPP Final with print outs 09.06.16.pdf', 'document_directory': './source', 'document_processed_date': '2023-08-17 20:20:14', 'pages': [{'page_number': 8, 'token_count': 415, 'content': 'NPP Implementation and Run SOW (NAB41496) to ITO Module (CON002328) and MOA (CON002254)  \nNAB & SUPPLIER CONFIDENTIAL                                      26999162_67  Page 8 of 243 \n Dovetail ; \n SunGard Financial Services ; \n Smartstream Technologies ; \n ACI Worldwide Inc. ; \n Fidelity Information Systems ; \n Fiserv ; \n Bottomline Technologies (including Sterci)  \n CGI (including Logica) ; \n Polaris CGI (including Logica) (including iGTB) ; \n Nucleus Software ; \n Reval ; \n HCL; \n Logica ; \n SilverLake ; \n Oracle ; \n NTT Data ; \n TCS; and  \n IBM. \nFundtech IP  has the meaning given in clause 6.5 of Appendix 15 . \nFundtech IP Transfer Conditions means the terms  and conditions set out in clause 1.2 of Appendix \n15.   \nFundtech Materials has the meaning given to it in clause 1.2(c) of Appendix 15 .  \nGo Live  means the date the Solution provided by the Service Provider has passed Industry Testing 1 to \n4 and goes live and has started processing customer transactions in a production environment ( Goes \nLive, Go-Live and Gone Live  have  a corresponding meaning).  \nGo Live Date  means the date set out in the Industry Schedule (currently set by NPPA as 27 August \n2017 ), as amended from time to time by NPPA . \nGood Industry Practice  means:  \n using standards, practices, methods and procedures conforming to the banking laws (as \napplicable) and all other laws relevant to the performance of the Services; and  \n exercising that degree of skill and care, diligence, prudence and foresight which would reasonably \nand ordinarily be expected from a skilled and experienced provider of services that are of the \nsame nature as the Services for a customer that operates a banking payment system.  ', 'processed': True}, {'page_number': 9, 'token_count': 638, 'content': 'NPP Implementation and Run SOW (NAB41496) to ITO Module (CON002328) and MOA (CON002254)  \nNAB & SUPPLIER CONFIDENTIAL                                      26999162_67  Page 9 of 243 Government Agency means any governmental, semi -governmental , administrative, f iscal, judicial or \nquasi -judicial body, de partment, commission , authority , tribunal, agency or entity.   \nGPP  means Global PayPlus  or GlobalPAYplus . \nGRC  means Group Risk Compliance . \nHours of Coverage means twenty -four ( 24) hours per day,  seven (7) days per week,  365 (or 366 , as \napplicable ) days per year.   \nHLD means high level design.   \nHSM  means Hardware Security Module . \nIAM means NAB  Identity and Access Management.  \nIBM GTS has the meaning given to it in clause 1.2(f) of Appendix 15 . \nIBM GTS Services has the meaning given to it in clause 1.2(f) of Appendix 15 . \nIBM GTS Scope of Access has the meaning given to it in clause 1.2(f) of Appendix 15 . \nIDAM  means Oracle Identity and Access Management . \nImpact Assessment Form  means the form of that name set out in Schedule 4 of the MOA.  \nImplementation Phase means  the period of time and activities performed or to be performed in \ndesigning and building the Solution prior to Go Live  and includes those activities d escribed in Appendix \n2.2.  \nImplementation Services means the Services to be performed by the Service Provider during the \nImplementation Phase.  \nIncident has the meaning given in Attachment 1 the ITO Module.   \nIndustry Schedule  means the schedule se t out in  ‘05.16.19 NPP High Level Industry Plan 20150721 \nv0.20.mpp’ (forming part of  Appendix 1 ) as updated from time to time.   \nInstallation Site  means the NAB data centres.  \nInitial Term  has the meaning given in clause 4.2. \nIntellectual Property Rights has the meaning given in the MOA .  \nITO Module has the me aning given to it in clause 2.1.  \nKey Milestone  has the meaning given in Appendix 13 .   \nKey Performance Indicator or KPI has the meaning given in the ITO Module .  \nKey Positions are set out in Appendix 7 .  \nKey Personnel has the meaning given in the MOA and are set out in Appendix 7 .  \nLaws  means the co mmon law and any statute, regulation, order, rule, subordinate legislation, regulatory \ncodes, guidelines, licence, permit, authorisation, accreditation, code of practice or other document or \nrequirement enforceable or issued under any statute, regulation, order, rule or subordinate legislation . \nLiquidated Damages  means the amounts specified as such in clause 10 of Appendix 15  for the \nrelevant Key Milestone . ', 'processed': True}, {'page_number': 10, 'token_count': 688, 'content': 'NPP Implementation and Run SOW (NAB41496) to ITO Module (CON002328) and MOA (CON002254)  \nNAB & SUPPLIER CONFIDENTIAL                                      26999162_67  Page 10 of 243 Locations  has the meaning given in clause 11.  \nLoss  means any loss , liability, damage, cost or expense (including all legal and other professional costs \nand disbursements).  \nMajor Regulatory Change has the meaning given to it in clause 11 of Appendix 15 .  \nMinor Regulatory Change has the meaning given to it in clause 11 of Appendix 15 .  \nManagement Board  has the meaning given in  Schedule 1 of  the MOA.  \nMilestone  means  the completion or achievement of an agreed activity or result (or set of activities or \nresults) by the Service Provider, as specified in this Agreement  or the  Project P lan.  Milestones may \ninclude (without limitation) delivering specific Deliverables, ach ieving Acceptance for specific \nDeliverables, and achieving Acceptance for the Solution.  \nMinor Enhancement  has the meaning given in Appendix 4.4.    \nMOA has the meaning given to it in clause 2.1. \nNAB means National Australia Bank Limited.  \nNAB Agreements has the meaning given to it in clause 7.12(b) . \nNAB Assets  means the data centres and any other asset approved by NAB for the purposes of \nproviding the Services.  \nNAB Data Centre means the data centre operated by NAB.  \nNAB Direct Loss  has the meaning given in clause 18 of Appendix 15 . \nNAB Group has the meaning given to it in the MOA.  \nNAB Group Company has the meaning given in the MOA.  \nNAB Compensation Amount  has the meaning given to it in clause 18 of Appendix 15 .  \nNAB Nominee means a third party engaged by NAB to act on its behalf under this Agreement  or \notherwise provide a service to NAB,  subject to compliance with Fundtech IP Transfer Conditions.  \nNAB’s NPP Program  means NAB’s program to implement, and to exploit the potential of, the industry \nsponsored NPP and includes the receipt of services, goods and/or solution to be provided by the \nService Provider  and the ongoing maintenance and enhancement of the Payments Pla tform.  \nNAB Permitted Entities  means  NAB and each NAB Group Company and NAB Nominees.  \nNAB Policies means NAB’s wri tten policies, guidelines, proc edures and standards which are noti fied to \nService Provider  in writing  from time to time and includes any update s to such policies, guidelines, \nprocedures and standards which are notified by NAB to the Service Provider in writing from time to time  \nNFT means Non Functional Test . \nNPP or NPP Program  has the meaning given in clause 5.1. \nNPPA  means  NPP Australia Limited.  \nNPP Rules means all rules and mandatory requirements issued by NPPA from time to time  as notified \nby NAB to the Service Provider . \nObje ctives  has the meaning given in clause 5.3. ', 'processed': True}]}
2023-08-17 21:03:36,103 - utils - DEBUG - get_content - Prompt: 
    Role:
    You are a Program Directory in a large IT outsourcing company.

    Background:
    Your task involves reviewing contracts and pulling from them all of the pertinent information that will impact the delivery of your projects.
    For refernence use the prince2 project methodology as a guide for understanding what elements are important to a project.

    Task:
    Process the text below sentence by sentence, review each sentence and determine if it has changed subject from the previous sentence.
    Remeber that the subject of a sentence is whats relevent to managing a project.
    Every time a sentence changes subject, create a new content section in the output json object, add a sumary of the content, then and add all the sentences since the last subject change as reference objects, splitting them as appropriate if the subject crosses paragraphs.
    If json object already has a content section, take care to track the relevent page change.
    If the sentence is a header or footer, and the header or footer section of the json object is blank, then add it, otherwise ignore it.
2023-08-17 21:03:36,103 - utils - DEBUG - get_content - content schema: {'name': 'content_summary', 'description': 'output object for a content summary', 'parameters': {'title': 'Content', 'type': 'object', 'properties': {'summary': {'title': 'Summary', 'type': 'string'}, 'create_date': {'title': 'Create Date', 'type': 'string', 'format': 'date'}, 'last_updated': {'title': 'Last Updated', 'type': 'string', 'format': 'date'}, 'token_count': {'title': 'Token Count', 'type': 'integer'}, 'references': {'title': 'References', 'type': 'array', 'items': {'$ref': '#/definitions/Reference'}}}, 'required': ['summary', 'create_date', 'last_updated', 'token_count', 'references'], 'definitions': {'Reference': {'title': 'Reference', 'type': 'object', 'properties': {'folder': {'title': 'Folder', 'type': 'string'}, 'document': {'title': 'Document', 'type': 'string'}, 'page': {'title': 'Page', 'type': 'string'}, 'paragraph': {'title': 'Paragraph', 'type': 'string'}, 'content': {'title': 'Content', 'type': 'string'}}, 'required': ['folder', 'document', 'page', 'paragraph', 'content']}}}, 'return_type': 'json'}
2023-08-17 21:03:36,104 - utils - DEBUG - get_content - current_json: {'document_name': 'NAP NPP Final with print outs 09.06.16.pdf', 'document_directory': './source', 'document_processed_date': '2023-08-17 20:20:14', 'pages': [{'page_number': 8, 'token_count': 415, 'content': 'NPP Implementation and Run SOW (NAB41496) to ITO Module (CON002328) and MOA (CON002254)  \nNAB & SUPPLIER CONFIDENTIAL                                      26999162_67  Page 8 of 243 \n Dovetail ; \n SunGard Financial Services ; \n Smartstream Technologies ; \n ACI Worldwide Inc. ; \n Fidelity Information Systems ; \n Fiserv ; \n Bottomline Technologies (including Sterci)  \n CGI (including Logica) ; \n Polaris CGI (including Logica) (including iGTB) ; \n Nucleus Software ; \n Reval ; \n HCL; \n Logica ; \n SilverLake ; \n Oracle ; \n NTT Data ; \n TCS; and  \n IBM. \nFundtech IP  has the meaning given in clause 6.5 of Appendix 15 . \nFundtech IP Transfer Conditions means the terms  and conditions set out in clause 1.2 of Appendix \n15.   \nFundtech Materials has the meaning given to it in clause 1.2(c) of Appendix 15 .  \nGo Live  means the date the Solution provided by the Service Provider has passed Industry Testing 1 to \n4 and goes live and has started processing customer transactions in a production environment ( Goes \nLive, Go-Live and Gone Live  have  a corresponding meaning).  \nGo Live Date  means the date set out in the Industry Schedule (currently set by NPPA as 27 August \n2017 ), as amended from time to time by NPPA . \nGood Industry Practice  means:  \n using standards, practices, methods and procedures conforming to the banking laws (as \napplicable) and all other laws relevant to the performance of the Services; and  \n exercising that degree of skill and care, diligence, prudence and foresight which would reasonably \nand ordinarily be expected from a skilled and experienced provider of services that are of the \nsame nature as the Services for a customer that operates a banking payment system.  ', 'processed': True}, {'page_number': 9, 'token_count': 638, 'content': 'NPP Implementation and Run SOW (NAB41496) to ITO Module (CON002328) and MOA (CON002254)  \nNAB & SUPPLIER CONFIDENTIAL                                      26999162_67  Page 9 of 243 Government Agency means any governmental, semi -governmental , administrative, f iscal, judicial or \nquasi -judicial body, de partment, commission , authority , tribunal, agency or entity.   \nGPP  means Global PayPlus  or GlobalPAYplus . \nGRC  means Group Risk Compliance . \nHours of Coverage means twenty -four ( 24) hours per day,  seven (7) days per week,  365 (or 366 , as \napplicable ) days per year.   \nHLD means high level design.   \nHSM  means Hardware Security Module . \nIAM means NAB  Identity and Access Management.  \nIBM GTS has the meaning given to it in clause 1.2(f) of Appendix 15 . \nIBM GTS Services has the meaning given to it in clause 1.2(f) of Appendix 15 . \nIBM GTS Scope of Access has the meaning given to it in clause 1.2(f) of Appendix 15 . \nIDAM  means Oracle Identity and Access Management . \nImpact Assessment Form  means the form of that name set out in Schedule 4 of the MOA.  \nImplementation Phase means  the period of time and activities performed or to be performed in \ndesigning and building the Solution prior to Go Live  and includes those activities d escribed in Appendix \n2.2.  \nImplementation Services means the Services to be performed by the Service Provider during the \nImplementation Phase.  \nIncident has the meaning given in Attachment 1 the ITO Module.   \nIndustry Schedule  means the schedule se t out in  ‘05.16.19 NPP High Level Industry Plan 20150721 \nv0.20.mpp’ (forming part of  Appendix 1 ) as updated from time to time.   \nInstallation Site  means the NAB data centres.  \nInitial Term  has the meaning given in clause 4.2. \nIntellectual Property Rights has the meaning given in the MOA .  \nITO Module has the me aning given to it in clause 2.1.  \nKey Milestone  has the meaning given in Appendix 13 .   \nKey Performance Indicator or KPI has the meaning given in the ITO Module .  \nKey Positions are set out in Appendix 7 .  \nKey Personnel has the meaning given in the MOA and are set out in Appendix 7 .  \nLaws  means the co mmon law and any statute, regulation, order, rule, subordinate legislation, regulatory \ncodes, guidelines, licence, permit, authorisation, accreditation, code of practice or other document or \nrequirement enforceable or issued under any statute, regulation, order, rule or subordinate legislation . \nLiquidated Damages  means the amounts specified as such in clause 10 of Appendix 15  for the \nrelevant Key Milestone . ', 'processed': True}, {'page_number': 10, 'token_count': 688, 'content': 'NPP Implementation and Run SOW (NAB41496) to ITO Module (CON002328) and MOA (CON002254)  \nNAB & SUPPLIER CONFIDENTIAL                                      26999162_67  Page 10 of 243 Locations  has the meaning given in clause 11.  \nLoss  means any loss , liability, damage, cost or expense (including all legal and other professional costs \nand disbursements).  \nMajor Regulatory Change has the meaning given to it in clause 11 of Appendix 15 .  \nMinor Regulatory Change has the meaning given to it in clause 11 of Appendix 15 .  \nManagement Board  has the meaning given in  Schedule 1 of  the MOA.  \nMilestone  means  the completion or achievement of an agreed activity or result (or set of activities or \nresults) by the Service Provider, as specified in this Agreement  or the  Project P lan.  Milestones may \ninclude (without limitation) delivering specific Deliverables, ach ieving Acceptance for specific \nDeliverables, and achieving Acceptance for the Solution.  \nMinor Enhancement  has the meaning given in Appendix 4.4.    \nMOA has the meaning given to it in clause 2.1. \nNAB means National Australia Bank Limited.  \nNAB Agreements has the meaning given to it in clause 7.12(b) . \nNAB Assets  means the data centres and any other asset approved by NAB for the purposes of \nproviding the Services.  \nNAB Data Centre means the data centre operated by NAB.  \nNAB Direct Loss  has the meaning given in clause 18 of Appendix 15 . \nNAB Group has the meaning given to it in the MOA.  \nNAB Group Company has the meaning given in the MOA.  \nNAB Compensation Amount  has the meaning given to it in clause 18 of Appendix 15 .  \nNAB Nominee means a third party engaged by NAB to act on its behalf under this Agreement  or \notherwise provide a service to NAB,  subject to compliance with Fundtech IP Transfer Conditions.  \nNAB’s NPP Program  means NAB’s program to implement, and to exploit the potential of, the industry \nsponsored NPP and includes the receipt of services, goods and/or solution to be provided by the \nService Provider  and the ongoing maintenance and enhancement of the Payments Pla tform.  \nNAB Permitted Entities  means  NAB and each NAB Group Company and NAB Nominees.  \nNAB Policies means NAB’s wri tten policies, guidelines, proc edures and standards which are noti fied to \nService Provider  in writing  from time to time and includes any update s to such policies, guidelines, \nprocedures and standards which are notified by NAB to the Service Provider in writing from time to time  \nNFT means Non Functional Test . \nNPP or NPP Program  has the meaning given in clause 5.1. \nNPPA  means  NPP Australia Limited.  \nNPP Rules means all rules and mandatory requirements issued by NPPA from time to time  as notified \nby NAB to the Service Provider . \nObje ctives  has the meaning given in clause 5.3. ', 'processed': True}]}
2023-08-17 21:03:36,104 - utils - DEBUG - get_content - ----------------------
                 current_prompt: 
                 -------------------------
                 
    Role:
    You are a Program Directory in a large IT outsourcing company.

    Background:
    Your task involves reviewing contracts and pulling from them all of the pertinent information that will impact the delivery of your projects.
    For refernence use the prince2 project methodology as a guide for understanding what elements are important to a project.

    Task:
    Process the text below sentence by sentence, review each sentence and determine if it has changed subject from the previous sentence.
    Remeber that the subject of a sentence is whats relevent to managing a project.
    Every time a sentence changes subject, create a new content section in the output json object, add a sumary of the content, then and add all the sentences since the last subject change as reference objects, splitting them as appropriate if the subject crosses paragraphs.
    If json object already has a content section, take care to track the relevent page change.
    If the sentence is a header or footer, and the header or footer section of the json object is blank, then add it, otherwise ignore it. Dont populate the reviewers list at this stage.
    INPUT:
    {'document_name': 'NAP NPP Final with print outs 09.06.16.pdf', 'document_directory': './source', 'document_processed_date': '2023-08-17 20:20:14', 'pages': [{'page_number': 8, 'token_count': 415, 'content': 'NPP Implementation and Run SOW (NAB41496) to ITO Module (CON002328) and MOA (CON002254)  \nNAB & SUPPLIER CONFIDENTIAL                                      26999162_67  Page 8 of 243 \n Dovetail ; \n SunGard Financial Services ; \n Smartstream Technologies ; \n ACI Worldwide Inc. ; \n Fidelity Information Systems ; \n Fiserv ; \n Bottomline Technologies (including Sterci)  \n CGI (including Logica) ; \n Polaris CGI (including Logica) (including iGTB) ; \n Nucleus Software ; \n Reval ; \n HCL; \n Logica ; \n SilverLake ; \n Oracle ; \n NTT Data ; \n TCS; and  \n IBM. \nFundtech IP  has the meaning given in clause 6.5 of Appendix 15 . \nFundtech IP Transfer Conditions means the terms  and conditions set out in clause 1.2 of Appendix \n15.   \nFundtech Materials has the meaning given to it in clause 1.2(c) of Appendix 15 .  \nGo Live  means the date the Solution provided by the Service Provider has passed Industry Testing 1 to \n4 and goes live and has started processing customer transactions in a production environment ( Goes \nLive, Go-Live and Gone Live  have  a corresponding meaning).  \nGo Live Date  means the date set out in the Industry Schedule (currently set by NPPA as 27 August \n2017 ), as amended from time to time by NPPA . \nGood Industry Practice  means:  \n using standards, practices, methods and procedures conforming to the banking laws (as \napplicable) and all other laws relevant to the performance of the Services; and  \n exercising that degree of skill and care, diligence, prudence and foresight which would reasonably \nand ordinarily be expected from a skilled and experienced provider of services that are of the \nsame nature as the Services for a customer that operates a banking payment system.  ', 'processed': True}, {'page_number': 9, 'token_count': 638, 'content': 'NPP Implementation and Run SOW (NAB41496) to ITO Module (CON002328) and MOA (CON002254)  \nNAB & SUPPLIER CONFIDENTIAL                                      26999162_67  Page 9 of 243 Government Agency means any governmental, semi -governmental , administrative, f iscal, judicial or \nquasi -judicial body, de partment, commission , authority , tribunal, agency or entity.   \nGPP  means Global PayPlus  or GlobalPAYplus . \nGRC  means Group Risk Compliance . \nHours of Coverage means twenty -four ( 24) hours per day,  seven (7) days per week,  365 (or 366 , as \napplicable ) days per year.   \nHLD means high level design.   \nHSM  means Hardware Security Module . \nIAM means NAB  Identity and Access Management.  \nIBM GTS has the meaning given to it in clause 1.2(f) of Appendix 15 . \nIBM GTS Services has the meaning given to it in clause 1.2(f) of Appendix 15 . \nIBM GTS Scope of Access has the meaning given to it in clause 1.2(f) of Appendix 15 . \nIDAM  means Oracle Identity and Access Management . \nImpact Assessment Form  means the form of that name set out in Schedule 4 of the MOA.  \nImplementation Phase means  the period of time and activities performed or to be performed in \ndesigning and building the Solution prior to Go Live  and includes those activities d escribed in Appendix \n2.2.  \nImplementation Services means the Services to be performed by the Service Provider during the \nImplementation Phase.  \nIncident has the meaning given in Attachment 1 the ITO Module.   \nIndustry Schedule  means the schedule se t out in  ‘05.16.19 NPP High Level Industry Plan 20150721 \nv0.20.mpp’ (forming part of  Appendix 1 ) as updated from time to time.   \nInstallation Site  means the NAB data centres.  \nInitial Term  has the meaning given in clause 4.2. \nIntellectual Property Rights has the meaning given in the MOA .  \nITO Module has the me aning given to it in clause 2.1.  \nKey Milestone  has the meaning given in Appendix 13 .   \nKey Performance Indicator or KPI has the meaning given in the ITO Module .  \nKey Positions are set out in Appendix 7 .  \nKey Personnel has the meaning given in the MOA and are set out in Appendix 7 .  \nLaws  means the co mmon law and any statute, regulation, order, rule, subordinate legislation, regulatory \ncodes, guidelines, licence, permit, authorisation, accreditation, code of practice or other document or \nrequirement enforceable or issued under any statute, regulation, order, rule or subordinate legislation . \nLiquidated Damages  means the amounts specified as such in clause 10 of Appendix 15  for the \nrelevant Key Milestone . ', 'processed': True}, {'page_number': 10, 'token_count': 688, 'content': 'NPP Implementation and Run SOW (NAB41496) to ITO Module (CON002328) and MOA (CON002254)  \nNAB & SUPPLIER CONFIDENTIAL                                      26999162_67  Page 10 of 243 Locations  has the meaning given in clause 11.  \nLoss  means any loss , liability, damage, cost or expense (including all legal and other professional costs \nand disbursements).  \nMajor Regulatory Change has the meaning given to it in clause 11 of Appendix 15 .  \nMinor Regulatory Change has the meaning given to it in clause 11 of Appendix 15 .  \nManagement Board  has the meaning given in  Schedule 1 of  the MOA.  \nMilestone  means  the completion or achievement of an agreed activity or result (or set of activities or \nresults) by the Service Provider, as specified in this Agreement  or the  Project P lan.  Milestones may \ninclude (without limitation) delivering specific Deliverables, ach ieving Acceptance for specific \nDeliverables, and achieving Acceptance for the Solution.  \nMinor Enhancement  has the meaning given in Appendix 4.4.    \nMOA has the meaning given to it in clause 2.1. \nNAB means National Australia Bank Limited.  \nNAB Agreements has the meaning given to it in clause 7.12(b) . \nNAB Assets  means the data centres and any other asset approved by NAB for the purposes of \nproviding the Services.  \nNAB Data Centre means the data centre operated by NAB.  \nNAB Direct Loss  has the meaning given in clause 18 of Appendix 15 . \nNAB Group has the meaning given to it in the MOA.  \nNAB Group Company has the meaning given in the MOA.  \nNAB Compensation Amount  has the meaning given to it in clause 18 of Appendix 15 .  \nNAB Nominee means a third party engaged by NAB to act on its behalf under this Agreement  or \notherwise provide a service to NAB,  subject to compliance with Fundtech IP Transfer Conditions.  \nNAB’s NPP Program  means NAB’s program to implement, and to exploit the potential of, the industry \nsponsored NPP and includes the receipt of services, goods and/or solution to be provided by the \nService Provider  and the ongoing maintenance and enhancement of the Payments Pla tform.  \nNAB Permitted Entities  means  NAB and each NAB Group Company and NAB Nominees.  \nNAB Policies means NAB’s wri tten policies, guidelines, proc edures and standards which are noti fied to \nService Provider  in writing  from time to time and includes any update s to such policies, guidelines, \nprocedures and standards which are notified by NAB to the Service Provider in writing from time to time  \nNFT means Non Functional Test . \nNPP or NPP Program  has the meaning given in clause 5.1. \nNPPA  means  NPP Australia Limited.  \nNPP Rules means all rules and mandatory requirements issued by NPPA from time to time  as notified \nby NAB to the Service Provider . \nObje ctives  has the meaning given in clause 5.3. ', 'processed': True}]}
    
                 -------------------------
2023-08-17 21:03:41,953 - utils - DEBUG - get_content - response:{
  "id": "chatcmpl-7oV4qVfPmf0oTOVYb2GZqzXyPCBgR",
  "object": "chat.completion",
  "created": 1692270216,
  "model": "gpt-3.5-turbo-16k-0613",
  "choices": [
    {
      "index": 0,
      "message": {
        "role": "assistant",
        "content": null,
        "function_call": {
          "name": "content_summary",
          "arguments": "{\n  \"summary\": \"Contract review for NAB NPP Implementation and Run SOW (NAB41496) to ITO Module (CON002328) and MOA (CON002254)\",\n  \"create_date\": \"2023-08-17 20:20:14\",\n  \"last_updated\": \"2023-08-17 20:20:14\",\n  \"token_count\": 1741,\n  \"references\": []\n}"
        }
      },
      "finish_reason": "stop"
    }
  ],
  "usage": {
    "prompt_tokens": 2337,
    "completion_tokens": 94,
    "total_tokens": 2431
  }
}
2023-08-17 21:03:41,953 - utils - INFO - get_content - First Answer run: {'summary': 'Contract review for NAB NPP Implementation and Run SOW (NAB41496) to ITO Module (CON002328) and MOA (CON002254)', 'create_date': '2023-08-17 20:20:14', 'last_updated': '2023-08-17 20:20:14', 'token_count': 1741, 'references': []}
2023-08-17 21:03:41,953 - utils - DEBUG - get_content - First Answer message: {
  "role": "assistant",
  "content": null,
  "function_call": {
    "name": "content_summary",
    "arguments": "{\n  \"summary\": \"Contract review for NAB NPP Implementation and Run SOW (NAB41496) to ITO Module (CON002328) and MOA (CON002254)\",\n  \"create_date\": \"2023-08-17 20:20:14\",\n  \"last_updated\": \"2023-08-17 20:20:14\",\n  \"token_count\": 1741,\n  \"references\": []\n}"
  }
}
2023-08-17 21:03:41,953 - utils - INFO - <module> - {'summary': 'Contract review for NAB NPP Implementation and Run SOW (NAB41496) to ITO Module (CON002328) and MOA (CON002254)', 'create_date': '2023-08-17 20:20:14', 'last_updated': '2023-08-17 20:20:14', 'token_count': 1741, 'references': []}
